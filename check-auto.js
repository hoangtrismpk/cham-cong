const { createClient } = require('@supabase/supabase-js'); const fs = require('fs'); const env = fs.readFileSync('.env.local', 'utf8'); const url = env.match(/NEXT_PUBLIC_SUPABASE_URL=(.*)/)[1]; const key = env.match(/SUPABASE_SERVICE_ROLE_KEY=(.*)/)[1]; const supabase = createClient(url, key); async function confirmAll() { const { data: { users }, error } = await supabase.auth.admin.listUsers(); if (error) return console.error(error); let count = 0; for (const u of users) { if (!u.email_confirmed_at) { await supabase.auth.admin.updateUserById(u.id, { email_confirm: true }); console.log('Confirmed:', u.email); count++; } } console.log('Done! Confirmed ' + count + ' users.'); } confirmAll();
